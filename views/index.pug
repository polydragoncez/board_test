doctype html
html
	head
		title=title
		script(src='./socket.io.js')
		script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js')
	body
		H1 #{title}
		script(type='text/javascript').
			$(function () { 	
				var socket = io.connect('http://localhost:3000');
				socket.on('message', function(data){
					console.log(data)
					$("#message_block").empty();
					data.map(obj=>{
						$("#message_block").append(
						"<div style='border: solid 1px;'>"+
						"<p>"+ obj.author + '&nbsp' + obj.email +"</p>" + 
						"</p>"+ obj.content +"</p>" + 
						"</p>"+ obj.time +"</p>" +
						"</div>"
						);
					})
				}); 
				socket.on('validError', function(data){
					alert(data)
				}); 
				$("#submit").click(function() {
					var post = {
						author: $('#author').val(), 
						email: $('#email').val(),
						time: $('#time').val(),
						content: $('#content').val()
					}
					socket.emit('message', post);
				});
				setInterval(function(){
					$('#time').val(new Date());
				}, 1000);
			});
	div#message_block
	form(method='post')
		p author
			input#author(name='author')
		p email
			input#email(name='email')
		p time
			input#time(name='time', style='width:250px;', readonly)
		p content
			input#content(name='content')
		input#submit(type='button', value='submit')